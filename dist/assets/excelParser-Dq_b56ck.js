import{e as I}from"./exceljs.min-C7gE75I7.js";import{g as j}from"./index-HoZP0huy.js";async function H(f){var w,k,d,p,g;if(f.length!==2)throw new Error("Exactly two Excel files are required (OP + ANE).");let l="";const m=[];for(const x of f){const y=new I.Workbook,_=await x.arrayBuffer();await y.xlsx.load(_);const o=y.worksheets[0],c=x.name.toLowerCase().includes("ane")?"ane":"op",C=c==="ane",v=C?2:3,S=3;let h=c==="op"?"op_ssk":"ane_ssk";const E=[];for(let e=S;e<S+5;e++){const n=((w=o.getCell(v,e).value)==null?void 0:w.toString().trim())||"",[s,t]=n.split(" ");if(!l&&t){const i=2e3+parseInt(t.slice(0,2)),u=parseInt(t.slice(2,4))-1,r=parseInt(t.slice(4,6)),a=new Date(i,u,r);l=`v.${j(a).toString().padStart(2,"0")}`}E.push({col:e,name:s,date:t})}for(let e=v+1;e<o.rowCount;e++){const n=(k=o.getCell(e,2).value)==null?void 0:k.toString().trim();if(!n)continue;const s=n.toLowerCase();if(s.includes("usk")){h=C?"ane_usk":"op_usk";continue}if(!["kÃ¤k","antal","vakant"].some(t=>s.includes(t)))for(const{col:t,name:i,date:u}of E){const r=((d=o.getCell(e,t).value)==null?void 0:d.toString().trim())||"",a=((p=o.getCell(e+1,t).value)==null?void 0:p.toString().trim())||"",b=((g=o.getCell(e+2,t).value)==null?void 0:g.toString().trim())||"";!r&&!a&&!b||m.push({name:n,role:h,weekday:i,date:u,workHours:r,comments:a||void 0,extraInfo:b||void 0,sourceFile:c})}}}return{week:l,staff:m}}export{H as parseExcelFiles};
